{"schemaVersion":{"major":0,"minor":3,"patch":0},"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/Lighter\/documentation\/Lighter\/Performance"},"sections":[],"abstract":[{"text":"A quick look at Lighter performance.","type":"text"}],"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/lighter\/performance"]}],"hierarchy":{"paths":[["doc:\/\/Lighter\/documentation\/Lighter"]]},"kind":"article","seeAlsoSections":[{"title":"Advanced","identifiers":["doc:\/\/Lighter\/documentation\/Lighter\/Configuration","doc:\/\/Lighter\/documentation\/Lighter\/Linux","doc:\/\/Lighter\/documentation\/Lighter\/Manual","doc:\/\/Lighter\/documentation\/Lighter\/SQLiteAPI","doc:\/\/Lighter\/documentation\/Lighter\/Mapping","doc:\/\/Lighter\/documentation\/Lighter\/Migrations"],"generated":true}],"primaryContentSections":[{"content":[{"type":"heading","level":2,"text":"Overview","anchor":"Overview"},{"inlineContent":[{"text":"Lighter comes with a small","type":"text"},{"type":"text","text":" "},{"identifier":"https:\/\/github.com\/Lighter-swift\/PerformanceTestSuite","isActive":true,"type":"reference"},{"text":".","type":"text"},{"type":"text","text":" "},{"text":"It uses the (larger, populated)","type":"text"},{"text":" ","type":"text"},{"identifier":"https:\/\/github.com\/jpwhite3\/northwind-SQLite3\/","type":"reference","isActive":true},{"type":"text","text":" "},{"text":"database as the base set.","type":"text"},{"type":"text","text":" "},{"text":"It doesn’t have the goal to be scientifically proper.","type":"text"}],"type":"paragraph"},{"type":"heading","level":3,"anchor":"Results","text":"Results"},{"type":"paragraph","inlineContent":[{"text":"The suite evaluates the load performance on queries against the “Orders” table,","type":"text"},{"type":"text","text":" "},{"text":"which has 16K records. The test loads all 16K records on each iteration.","type":"text"}]},{"type":"paragraph","inlineContent":[{"text":"Lighter is expected to perform excellent, as it directly\/statically binds","type":"text"},{"text":" ","type":"text"},{"text":"SQLite prepared statements for the generated structures.","type":"text"}]},{"type":"paragraph","inlineContent":[{"text":"M1 Mini with 10 rampup iterations and 500 test iterations.","type":"text"}]},{"type":"codeListing","syntax":null,"code":["Orders.fetchAll    setup    rampup   duration","  Enlighter SQLite 0        0,135s     6,629s   ~20% faster than Lighter (75\/s)","  Lighter          0        0,162s     7,927s   Baseline                 (63\/s)","  GRDB             -        -        ~12s       Handwritten Mapping","  SQLite.swift     0        0,613s    30,643s   Handwritten Mapping (>3× slower) (16\/s)","  GRDB             0,001    0,995s    49,404s   Codable (>6× slower)     (10\/s)","  SQLite.swift     0,001    3,109s   153,172s   Codable (>19× slower)    (3\/s)"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Essentially the specific testcase - with no handcrafting involved - needs 30"},{"type":"text","text":" "},{"text":"secs on GRDB, which is state of the art, 2.5 minutes w\/ SQLite.swift and","type":"text"},{"type":"text","text":" "},{"type":"text","text":"not quite 8 secs with the Lighter API."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"As a chart:"}]},{"type":"codeListing","syntax":null,"code":["┌─────────────────────────────────────────────────────────────────────────────┐","├─┐                                                                           │","│S│                Enlighter generated raw SQLite API Bindings   ~20% faster  │","├─┘                                                                           │","├──┐                                                                          │","│L3│               Lighter, w\/ high level API (baseline)            Baseline  │","├──┘                                                                          │","├─────┐                                                                       │","│GRDB │            with handwritten record mappings              ~50% slower  │","├─────┘                                                                       │","├─────────────┐                                                               │","│SQLite.swift │    with handwritten record mappings               >3× slower  │","├─────────────┘                                                               │","├───────────────────────┐                                                     │","│GRDB with Codable      │                                         >6× slower  │","├───────────────────────┘                                                     │","├───────────────────────────────────────────────────────────────────────────┐ │","│SQLite.swift with Codable                                       >19× slower│ │","├───────────────────────────────────────────────────────────────────────────┘ │","└─────────────────────────────────────────────────────────────────────────────┘","      Time to load the Northwind \"Products\" table 500 times into a model.      ","                              Shorter is faster.                               "]},{"inlineContent":[{"type":"emphasis","inlineContent":[{"text":"Main takeway","type":"text"}]},{"type":"text","text":": Never ever use Codable."}],"type":"paragraph"}],"kind":"content"}],"metadata":{"modules":[{"name":"Lighter.swift for SQLite3"}],"title":"Performance","roleHeading":"Article","role":"article"},"references":{"doc://Lighter/documentation/Lighter/Mapping":{"url":"\/documentation\/lighter\/mapping","role":"collectionGroup","identifier":"doc:\/\/Lighter\/documentation\/Lighter\/Mapping","abstract":[{"type":"text","text":"Mapping Data retrieved from the Database."}],"title":"Mapping","type":"topic","kind":"article"},"https://github.com/Lighter-swift/PerformanceTestSuite":{"title":"performance test suite","titleInlineContent":[{"type":"text","text":"performance test suite"}],"url":"https:\/\/github.com\/Lighter-swift\/PerformanceTestSuite","identifier":"https:\/\/github.com\/Lighter-swift\/PerformanceTestSuite","type":"link"},"https://github.com/jpwhite3/northwind-SQLite3/":{"titleInlineContent":[{"text":"Northwind SQLite","type":"text"}],"url":"https:\/\/github.com\/jpwhite3\/northwind-SQLite3\/","identifier":"https:\/\/github.com\/jpwhite3\/northwind-SQLite3\/","title":"Northwind SQLite","type":"link"},"doc://Lighter/documentation/Lighter/Manual":{"type":"topic","identifier":"doc:\/\/Lighter\/documentation\/Lighter\/Manual","kind":"article","title":"Manual Generation","url":"\/documentation\/lighter\/manual","abstract":[{"type":"text","text":"How to generate Lighter content by hand."}],"role":"article"},"doc://Lighter/documentation/Lighter/Migrations":{"kind":"article","identifier":"doc:\/\/Lighter\/documentation\/Lighter\/Migrations","role":"article","url":"\/documentation\/lighter\/migrations","type":"topic","abstract":[{"text":"Detecting schema changes and performing schema upgrades.","type":"text"}],"title":"Migrations"},"doc://Lighter/documentation/Lighter/Linux":{"kind":"article","identifier":"doc:\/\/Lighter\/documentation\/Lighter\/Linux","role":"article","url":"\/documentation\/lighter\/linux","type":"topic","abstract":[{"text":"Using Lighter on Linux.","type":"text"}],"title":"Linux"},"doc://Lighter/documentation/Lighter/SQLiteAPI":{"kind":"article","identifier":"doc:\/\/Lighter\/documentation\/Lighter\/SQLiteAPI","role":"article","url":"\/documentation\/lighter\/sqliteapi","type":"topic","abstract":[{"text":"Using the dependency-free SQLite API.","type":"text"}],"title":"Dependency-Free API"},"doc://Lighter/documentation/Lighter":{"url":"\/documentation\/lighter","kind":"symbol","type":"topic","role":"collection","identifier":"doc:\/\/Lighter\/documentation\/Lighter","title":"Lighter.swift for SQLite3","abstract":[{"type":"text","text":"Type-safe down to the schema. Very, "},{"inlineContent":[{"type":"text","text":"very"}],"type":"strong"},{"type":"text","text":", fast. Dependency free."}]},"doc://Lighter/documentation/Lighter/Configuration":{"role":"article","url":"\/documentation\/lighter\/configuration","identifier":"doc:\/\/Lighter\/documentation\/Lighter\/Configuration","type":"topic","kind":"article","title":"Configuration","abstract":[{"text":"The ","type":"text"},{"type":"codeVoice","code":"Lighter.json"},{"text":" configuration file.","type":"text"}]}}}